
---

# 🚀 Arbitrum Testnet ETF PoC 设计文档

## 1️⃣ 角色说明

| 角色                               | 功能                               | 代币/资产             |
| -------------------------------- | -------------------------------- | ----------------- |
| **User**                         | 购买 ETF 份额                        | USDC → ETF shares |
| **ETF Contract**                 | 管理 ETF，按比例组合 sAsset              | 持有 sBTC / sETH    |
| **sAsset Contracts**             | sUSD、sBTC、sETH ERC20，可 mint/burn | ERC20 Token       |
| **Staker / Collateral Provider** | 提供抵押品支撑 sAsset mint              |   USDC / ETH  |
| **Debt Pool**                    | 记录全局债务、抵押比例                      | -                 |
| **Oracle**                       | 提供 BTC/USD、ETH/USD 价格            | -                 |

---

## 2️⃣ 功能设计

### 2.1 ETF 合约核心功能

1. **buyETF(uint256 usdcAmount)**

   * 用户支付 USDC
   * 按比例（60% BTC, 40% ETH）兑换对应 sBTC/sETH
   * ETF 合约记录份额数量

2. **redeemETF(uint256 etfAmount)**

   * 用户赎回 ETF 份额
   * 按当前 sAsset 价格兑换等值 USDC
   * burn 对应 sBTC/sETH

3. **getNetAssetValue()**

   * 查询 ETF 当前净值
   * 公式：
     [
     \text{NAV} = 60% \times sBTC_{\text{price}} \times sBTC_{\text{balance}} + 40% \times sETH_{\text{price}} \times sETH_{\text{balance}}
     ]

---

### 2.2 sAsset 合约

* ERC20，只有抵押者可以 mint/burn
* mint 增加全局债务
* burn 减少全局债务

**主要函数：**

```solidity
function mint(address to, uint256 amount) external onlyStaker;
function burn(address from, uint256 amount) external onlySystem;
```

---

### 2.3 抵押者 / 全局债务池

* 用户抵押 SNX/USDC/ETH 支撑 sAsset
* 记录债务份额：

  * 例如：Alice 抵押 100 SNX，占系统 25% → 她承担 25% sBTC/sETH 债务
* 支持清算触发：

  * 当债务/抵押比例低于阈值 → 可被清算

---

### 2.4 Oracle

* 提供 BTC/USD 和 ETH/USD 价格
* 更新 sBTC 和 sETH 价格
* ETF 计算 NAV 时直接调用

**价格地址（Arbitrum Testnet Chainlink）：**

| 资产      | PriceFeed                                    |
| ------- | -------------------------------------------- |
| BTC/USD | `0x56a43EB56Da12C0dc1D972ACb089c06a5dEF8e69` |
| ETH/USD | `0xd30e2101a97dcbAeBCBC04F14C3f624E67A35165` |

---

## 3️⃣ 资金流示意

```
User USDC
   │
   ▼
ETF Contract
   │       ┌────────────┐
   │       │ Mint sAsset │
   │       │ (by Staker)│
   ▼       └────────────┘
sBTC/sETH balance in ETF
   │
   ▼
ETF shares issued to User
```

* ETF 持有 sBTC/sETH，用户持有 ETF shares
* sBTC/sETH 价格波动 → ETF NAV 变化 → 用户赎回时体现收益/亏损

---

## 4️⃣ 开发顺序（最小可行版）

1. **Oracle**：先把 BTC/USD、ETH/USD 测试网价格接入
2. **sAsset**：sUSD、sBTC、sETH ERC20，支持 mint/burn
3. **Debt Pool + Staker**：记录抵押比例和债务分配
4. **ETF Contract**：按 60/40 比例组合 sBTC/sETH，支持买入/赎回
5. **前端（可选）**：显示 ETF NAV、用户份额

---

## 5️⃣ 简化 PoC 注意点

* PoC 可先用固定价格 Oracle
* 抵押率可以固定，暂不实现清算
* ETF 合约直接 mint sBTC/sETH，不用 AMM
* 主要验证流程：

  1. 用户买入 ETF → 份额正确
  2. NAV 计算正确
  3. 赎回 USDC 正确

---

## 💡 总结

* **投资者** → 买 ETF → 拥有 ETF 份额
* **ETF 合约** → 持有 sBTC/sETH
* **Staker** → 提供抵押 → mint sBTC/sETH
* **Debt Pool** → 记录抵押者债务分配
* **Oracle** → 提供价格 → ETF 计算 NAV

---

